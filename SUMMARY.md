# é¡¹ç›®æ€»ç»“ - èˆèŒ DX å›½æœæ¸¸ç©è®°å½•è·å–

## ğŸ“¦ æ–°å¢çš„æ–‡ä»¶

æœ¬æ¬¡ä¸ºä½ åˆ›å»ºäº†ä»¥ä¸‹æ–‡ä»¶ï¼Œå¸®åŠ©ä½ è½»æ¾è·å–èˆèŒ DX å›½æœçš„æ¸¸ç©è®°å½•ï¼š

### ğŸ”§ é…ç½®æ–‡ä»¶
- **token.json** - ä½ çš„ Token é…ç½®æ–‡ä»¶ï¼ˆåŒ…å«å·²æå–çš„ ult å’Œ userIdï¼‰

### ğŸš€ æ‰§è¡Œè„šæœ¬
1. **test_token.js** - å¿«é€Ÿæµ‹è¯•è„šæœ¬
   - éªŒè¯ Token æ˜¯å¦æœ‰æ•ˆ
   - è·å–ç©å®¶èµ„æ–™
   - è·å–æœ€è¿‘ 5 æ¬¡æ¸¸ç©
   - è·å–å‰ 5 æ¡ Master è®°å½•

2. **get_all_data.js** - å®Œæ•´æ•°æ®è·å–è„šæœ¬
   - è·å–ç©å®¶å®Œæ•´èµ„æ–™
   - è·å–æœ€è¿‘ 50 æ¬¡æ¸¸ç©è®°å½•
   - è·å–æ‰€æœ‰éš¾åº¦çš„è®°å½•ï¼ˆBasic/Advanced/Expert/Master/Re:Masterï¼‰
   - è‡ªåŠ¨ä¿å­˜ä¸º JSON æ–‡ä»¶åˆ° output/ ç›®å½•

3. **quick_start.js** - å¿«é€Ÿå¯åŠ¨å·¥å…·
   - å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒé€‰æ‹©æ€§è·å–æ•°æ®
   - è‡ªåŠ¨è¯»å–å’Œæ›´æ–° token.json
   - æ”¯æŒå‚æ•°: profile, recent, master, all, full

### ğŸ“š æ–‡æ¡£
1. **ä½¿ç”¨è¯´æ˜.md** - è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
   - å®Œæ•´çš„å®‰è£…å’Œé…ç½®è¯´æ˜
   - API å‚è€ƒæ–‡æ¡£
   - è¿›é˜¶ä½¿ç”¨ç¤ºä¾‹
   - æ•°æ®åˆ†æä»£ç 
   - å¸¸è§é—®é¢˜è§£ç­”

2. **å¿«é€ŸæŒ‡å—.md** - ç®€æ˜å¿«é€ŸæŒ‡å—
   - ä¸‰æ­¥å¼€å§‹ä½¿ç”¨
   - æ–‡ä»¶è¯´æ˜
   - å¿«é€Ÿç¤ºä¾‹
   - é—®é¢˜æ’æŸ¥

3. **SUMMARY.md** - æœ¬æ–‡ä»¶ï¼Œé¡¹ç›®æ€»ç»“

### ğŸ”’ å®‰å…¨é…ç½®
- **.gitignore** - æ›´æ–°äº†å¿½ç•¥è§„åˆ™
  - å¿½ç•¥ token.jsonï¼ˆä¿æŠ¤éšç§ï¼‰
  - å¿½ç•¥ output/ ç›®å½•ï¼ˆæ•°æ®æ–‡ä»¶ï¼‰

---

## ğŸ¯ ä½ çš„ Token ä¿¡æ¯

å·²ä»æŠ“åŒ…æ•°æ®ä¸­æå–å¹¶é…ç½®ï¼š
```json
{
  "ult": "12c4b77a644b9e88a14ab3957aea7703",
  "userId": "2005990419238350"
}
```

**ä¿å­˜ä½ç½®**: `token.json`

---

## ğŸ“Š é¡¹ç›®ç†è§£

### é¡¹ç›®èƒŒæ™¯
- **åç§°**: mainetcn
- **ç‰ˆæœ¬**: 1.0.9
- **çŠ¶æ€**: å·²å½’æ¡£ï¼ˆArchivedï¼‰
- **ç”¨é€”**: èˆèŒ DX å›½æœæˆç»©æŸ¥è¯¢ API
- **æŠ€æœ¯**: Node.js + HTML ç½‘é¡µæŠ“å–

### æ ¸å¿ƒ API
é¡¹ç›®æä¾› 4 ä¸ªä¸»è¦ APIï¼š

1. **gamedata(token)** - ç©å®¶èµ„æ–™
   - æ–‡ä»¶: gamedata.js (61 è¡Œ)
   - è¿”å›: ç”¨æˆ·åã€Ratingã€ç§°å·ç­‰

2. **recent(token)** - æœ€è¿‘æ¸¸ç©
   - æ–‡ä»¶: recent.js (63 è¡Œ)
   - è¿”å›: æœ€è¿‘ 50 æ¬¡æ¸¸ç©è®°å½•

3. **record(token, level)** - æŒ‰éš¾åº¦æŸ¥è¯¢
   - æ–‡ä»¶: record.js (116 è¡Œ)
   - æ”¯æŒ: basic/advanced/expert/master/re:master/all
   - è¿”å›: æŒ‡å®šéš¾åº¦çš„æ‰€æœ‰è®°å½•

4. **trackdetail(token, trackid)** - å•æ¬¡è¯¦æƒ…
   - æ–‡ä»¶: trackdetail.js (135 è¡Œ)
   - è¿”å›: å•æ¬¡æ¸¸ç©çš„è¯¦ç»†åˆ¤å®šæ•°æ®

### æŠ€æœ¯å®ç°
- **è®¤è¯**: åŸºäº Cookie çš„ Tokenï¼ˆ_t å’Œ userIdï¼‰
- **è¯·æ±‚**: axios HTTP å®¢æˆ·ç«¯
- **è§£æ**: xmldom + xpathï¼ˆHTML DOM è§£æï¼‰
- **åˆ·æ–°**: æ¯æ¬¡è¯·æ±‚åè‡ªåŠ¨è¿”å›æ–° Token

---

## ğŸš€ ä½¿ç”¨æµç¨‹

### åœ¨æœ¬åœ°ç”µè„‘ä¸Šè¿è¡Œï¼ˆå¿…éœ€ï¼‰

âš ï¸ **é‡è¦**: å½“å‰å®¹å™¨ç¯å¢ƒæ— æ³•è®¿é—®èˆèŒæœåŠ¡å™¨ï¼Œå¿…é¡»åœ¨æœ¬åœ°è¿è¡Œï¼

#### æ­¥éª¤ 1: ä¸‹è½½åˆ°æœ¬åœ°
```bash
# å°†æ•´ä¸ª mainetcn æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ä½ çš„ç”µè„‘
```

#### æ­¥éª¤ 2: å®‰è£…ä¾èµ–
```bash
cd mainetcn
npm install
```

#### æ­¥éª¤ 3: è¿è¡Œæµ‹è¯•
```bash
node test_token.js
```

#### æ­¥éª¤ 4: è·å–å®Œæ•´æ•°æ®
```bash
node get_all_data.js
```

æŸ¥çœ‹ç»“æœï¼š
```bash
ls output/
# maimai_data_2025-11-21.json
# latest_token.json
```

---

## ğŸ“ˆ è¾“å‡ºæ•°æ®æ ¼å¼

### æ¸¸ç©è®°å½• (Recent)
```javascript
{
  "tracknum": "123",
  "date": "2025/11/21",
  "id": "xxxxxxx",
  "track": {
    "title": "æ›²å",
    "dx": true,
    "coverart": "URL",
    "difficulty": "master"
  },
  "grade": {
    "achivement": 99.5678,
    "dxscore": 450,
    "fullcombo": true,
    "fullsync": false,
    "rank": "SSS"
  }
}
```

### éš¾åº¦è®°å½• (Record)
```javascript
{
  "title": "æ›²å",
  "level": "13+",
  "diff": 3,
  "type": "standard",
  "achievements": 99.5,
  "dxScore": 450,
  "rate": "sss",
  "fc": "fc",
  "fs": "fsp"
}
```

---

## ğŸ”„ Token ç®¡ç†

### è‡ªåŠ¨æ›´æ–°æœºåˆ¶
æ‰€æœ‰è„šæœ¬éƒ½ä¼šè‡ªåŠ¨å¤„ç† Token æ›´æ–°ï¼š
- API è°ƒç”¨åè·å–æ–° Token
- è‡ªåŠ¨ä¿å­˜åˆ° token.json æˆ– latest_token.json
- ä¸‹æ¬¡ä½¿ç”¨æ›´æ–°åçš„ Token

### Token å¤±æ•ˆå¤„ç†
å¦‚æœçœ‹åˆ° "Expired or incorrect token pair"ï¼š

1. æ‰“å¼€ HttpCanary æŠ“åŒ…å·¥å…·
2. å¾®ä¿¡ â†’ èˆèŒ DX å…¬ä¼—å· â†’ æˆ‘çš„è®°å½•
3. æ‰¾åˆ° `maimai.wahlap.com/maimai-mobile/home/`
4. æå–å“åº”å¤´ä¸­çš„ `_t` å’Œ `userId`
5. æ›´æ–° token.json

---

## ğŸ’¡ è¿›é˜¶ä½¿ç”¨

### æ•°æ®åˆ†æç¤ºä¾‹

#### è®¡ç®— Master å¹³å‡è¾¾æˆç‡
```javascript
const data = require('./output/maimai_data_2025-11-21.json')
const avg = data.records.master.reduce((sum, r) => sum + r.achievements, 0) / data.records.master.length
console.log(`Master å¹³å‡: ${avg.toFixed(2)}%`)
```

#### æ‰¾å‡ºå¾… FC æ›²ç›®
```javascript
const needFC = data.records.master.filter(r => r.fc !== 'fc' && r.achievements >= 97)
console.log('æ¥è¿‘ FC çš„æ›²ç›®:', needFC.map(r => r.title))
```

#### å¯¼å‡ºä¸º Excel
```bash
npm install xlsx
```

```javascript
const XLSX = require('xlsx')
const data = require('./output/maimai_data_2025-11-21.json')
const ws = XLSX.utils.json_to_sheet(data.recentPlays)
const wb = XLSX.utils.book_new()
XLSX.utils.book_append_sheet(wb, ws, 'Recent')
XLSX.writeFile(wb, 'output/maimai.xlsx')
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### é¡¹ç›®å·²å½’æ¡£
- âœ… å½“å‰åŠŸèƒ½å¯æ­£å¸¸ä½¿ç”¨
- âŒ ä¸å†ä¿®å¤æ–° bug
- âŒ ç½‘é¡µç»“æ„å˜åŒ–å¯èƒ½å¯¼è‡´å¤±æ•ˆ
- âš ï¸  ä¾èµ–åŒ…ç‰ˆæœ¬è¾ƒæ—§ï¼ˆä½†å·²ä¿®å¤å·²çŸ¥æ¼æ´ï¼‰

### å®‰å…¨æç¤º
- ğŸ”’ Token ç›¸å½“äºè´¦å·å¯†ç ï¼Œå‹¿æ³„éœ²
- ğŸ”’ token.json å·²åŠ å…¥ .gitignore
- ğŸ”’ ä¸è¦ä¸Šä¼  token åˆ°å…¬å¼€ä»“åº“
- ğŸ”’ ä½¿ç”¨åå»ºè®®åœ¨å¾®ä¿¡é‡æ–°ç™»å½•åˆ·æ–° Token

### ä½¿ç”¨é™åˆ¶
- â±ï¸ é¿å…é¢‘ç¹è¯·æ±‚ï¼ˆè„šæœ¬å·²å†…ç½® 1 ç§’å»¶è¿Ÿï¼‰
- ğŸŒ éœ€è¦èƒ½è®¿é—® maimai.wahlap.com
- ğŸ’» å¿…é¡»åœ¨æœ¬åœ°ç¯å¢ƒè¿è¡Œï¼ˆå®¹å™¨ç¯å¢ƒæ— æ³•è®¿é—®ï¼‰

---

## ğŸ‰ æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ï¼š
- âœ… å®Œæ•´çš„é¡¹ç›®ç†è§£
- âœ… æœ‰æ•ˆçš„ Token é…ç½®
- âœ… 3 ä¸ªåŠŸèƒ½å®Œæ•´çš„è„šæœ¬
- âœ… è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£
- âœ… å®‰å…¨çš„é…ç½®ï¼ˆ.gitignoreï¼‰

**ä¸‹ä¸€æ­¥æ“ä½œ**ï¼š
1. ğŸ“¥ å°†é¡¹ç›®ä¸‹è½½åˆ°æœ¬åœ°ç”µè„‘
2. ğŸ“¦ è¿è¡Œ `npm install`
3. ğŸ§ª è¿è¡Œ `node test_token.js` æµ‹è¯•
4. ğŸ“Š è¿è¡Œ `node get_all_data.js` è·å–å®Œæ•´æ•°æ®
5. ğŸ“ˆ åˆ†æ `output/` ç›®å½•çš„ JSON æ•°æ®

---

## ğŸ“ è·å–å¸®åŠ©

- **è¯¦ç»†æ–‡æ¡£**: æŸ¥çœ‹ `ä½¿ç”¨è¯´æ˜.md`
- **å¿«é€Ÿä¸Šæ‰‹**: æŸ¥çœ‹ `å¿«é€ŸæŒ‡å—.md`
- **åŸé¡¹ç›®**: https://github.com/Astrian/mainetcn
- **Issues**: https://github.com/Astrian/mainetcn/issues

---

**åˆ›å»ºæ—¶é—´**: 2025-11-21
**Token æå–æ—¶é—´**: 2025-11-21
**é¡¹ç›®ç‰ˆæœ¬**: mainetcn 1.0.9

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ®âœ¨
