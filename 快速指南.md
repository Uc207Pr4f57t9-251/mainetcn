# 舞萌 DX 国服游玩记录获取 - 快速指南

## ✅ 你已经准备好了！

你的 Token 已配置：
- ✅ `ult`: 12c4b77a644b9e88a14ab3957aea7703
- ✅ `userId`: 2005990419238350
- ✅ 已保存到 `token.json`

---

## 🚀 三步开始使用

### 1️⃣ 下载到本地
```bash
# 将整个项目文件夹下载到你的电脑
# 或者克隆原项目并复制我创建的脚本
```

### 2️⃣ 安装依赖（首次使用）
```bash
cd mainetcn
npm install
```

### 3️⃣ 运行脚本
```bash
# 快速测试（推荐首次运行）
node test_token.js

# 使用快速启动脚本
node quick_start.js profile    # 查看玩家资料
node quick_start.js recent      # 查看最近游玩
node quick_start.js master      # 查看 Master 记录
node quick_start.js all         # 查看所有难度记录
node quick_start.js full        # 获取完整数据并保存

# 获取完整数据
node get_all_data.js
```

---

## 📁 我为你创建的文件

| 文件 | 说明 | 用途 |
|------|------|------|
| **token.json** | Token 配置文件 | 存储你的认证信息 |
| **test_token.js** | 快速测试脚本 | 验证 Token 并查看基本数据 |
| **get_all_data.js** | 完整数据获取 | 获取所有数据并保存为 JSON |
| **quick_start.js** | 快速启动工具 | 命令行工具，选择性获取数据 |
| **使用说明.md** | 详细文档 | 完整的使用教程和 API 说明 |

---

## 📊 输出示例

### test_token.js 会显示：
```
============================================================
舞萌 DX 国服数据查询测试
============================================================

📊 测试 1: 获取玩家资料...
✅ 玩家资料获取成功！
   用户名: 你的用户名
   Rating: 15000

🎮 测试 2: 获取最近游玩记录...
✅ 成功获取 50 条游玩记录！

最近 5 次游玩:
------------------------------------------------------------
1. 曲名
   难度: master | 类型: DX
   达成率: 99.5678% | 评级: SSS
   DX分数: 450
   FC: ✓ | FS: ✗
   游玩日期: 2025/11/21
...
```

### get_all_data.js 会创建：
```
output/
  ├── maimai_data_2025-11-21.json  (完整数据)
  └── latest_token.json             (更新后的 Token)
```

---

## 🔄 Token 管理

### 自动更新
所有脚本都会**自动更新 Token**：
- `test_token.js` - 显示新 Token
- `get_all_data.js` - 保存到 `output/latest_token.json`
- `quick_start.js` - 自动更新 `token.json`

### Token 失效怎么办？

如果看到错误 "Expired or incorrect token pair"：

1. **打开 HttpCanary**（小黄鸟）
2. **开始抓包**
3. **打开微信** → 舞萌 DX 公众号 → 我的记录
4. **找到** `https://maimai.wahlap.com/maimai-mobile/home/`
5. **查看响应头** → Set-Cookie
6. **提取** `_t` 和 `userId`
7. **更新** `token.json` 文件

---

## 💡 快速示例

### 查看你的最高分
```bash
node quick_start.js recent
```

### 导出所有 Master 记录
```bash
node quick_start.js master > master_records.txt
```

### 获取完整数据用于分析
```bash
node quick_start.js full
# 然后打开 output/maimai_data_XXXX.json
```

---

## 🎯 数据用途

拿到数据后你可以：
- 📈 分析进步趋势
- 🏆 统计高分曲目
- 📊 导出为 Excel
- 🔍 查找待 FC 曲目
- 📉 分析失误率
- 🎮 制作个人成绩网站

---

## ⚠️ 重要提醒

1. **在本地运行** - 当前容器环境无法访问舞萌服务器
2. **保护 Token** - 不要分享给他人
3. **网络要求** - 需要能访问 `maimai.wahlap.com`
4. **请求频率** - 脚本已内置延迟，避免频繁请求

---

## 🆘 遇到问题？

### 无法连接服务器
- 检查网络连接
- 尝试使用 VPN（如果在境外）
- 检查防火墙设置

### Token 总是失效
- 确保提取的是完整的 Token
- 不要在微信中访问数据后再运行脚本
- 每次运行后使用更新的 Token

### 数据不完整
- 服务器可能在维护
- 尝试增加脚本中的延迟时间
- 分批次获取数据

---

## 📞 更多帮助

查看 **使用说明.md** 获取：
- 详细的 API 文档
- 进阶使用示例
- 数据分析代码
- 导出为 Excel 的方法
- 常见问题解答

---

## 🎉 开始使用吧！

```bash
# 第一次运行建议执行：
node test_token.js

# 一切正常后获取完整数据：
node get_all_data.js

# 查看 output/ 目录的 JSON 文件
```

祝你玩得开心！🎮✨
